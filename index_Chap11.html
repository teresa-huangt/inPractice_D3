<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<title> chapter10 </title>
		<script type="text/javascript" src="./d3.js"></script>
		<style type="text/css">
			/* sth */
		</style>
	</head>

	<body>
		<h1> chapter11 </h1>
		<!-- d3.js -->
		<script type="text/javascript">
			// default parameters
			var w = 600;
			var h = 250;
			var dataSet = [];

			// load data from csv file
				// date format
			var parseDate = d3.timeParse("%Y/%m") //Y大写对应四个数字的年份
			var parseYear = d3.timeParse("%Y")

				// load
			d3.csv("mauna_loa_co2_monthly_averages.csv")
				.then(function(d){
					console.log(d[0])
					console.log(typeof d[0].year)
					console.log(typeof d[0].month)
					console.log(typeof d[0].average)


					var data = []
					for (var i = 0; i < d.length; i++){
						data[i] = []
						data[i].date = d[i].year + "/" + d[i].month
						data[i].date = parseDate(data[i].date)
						data[i].value = +d[i].average // + means convert to number

					}
					dataSet = data;
					console.log(dataSet[0])
					console.log(typeof dataSet[0].date)
					console.log(typeof dataSet[0].value)
					
					//sconsole.table(dataSet, ["date", "value"])//表格形式展示数据

				// scale setup
				xScale = d3.scaleTime() //这里是scaleTime
							.domain([d3.min(dataSet, function(d) { return d.date}), 
									d3.max(dataSet, function(d) { return d.date})])
							.range([0, w])

				yScale = d3.scaleLinear()
							.domain([0, d3.max(dataSet, function(d) { return d.value})])
							.range([h, 0])

				//  line setup
				var line = d3.line()
							.x(function(d) { return xScale(d.date)})
							.y(function(d) { return yScale(d.value)})

				// create SVG
				var svg = d3.select("body")
							.append("svg")
							.attr("width", w)
							.attr("height", h)	
					// create line
				svg.append("line")
					.datum(dataSet)
					.attr("class", "line")
					.attr("id", line) // 这里line没有引号


				}) // end of csv then function

		</script>

	</body>


</html>